<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Отчеты</title>
  <link rel="stylesheet" href="app.css" />
</head>
<body>
  <div class="reports-app">
    <header class="topbar">
      <div>
        <h1 class="title">Отчеты</h1>
        <p class="subtitle">Сценарии генерации через DocumentBuilder</p>
      </div>
      <div class="topbar-actions">
        <div class="search-wrap">
          <input id="search-input" type="text" placeholder="Поиск сценариев" />
        </div>
        <button id="btn-export-pack" class="btn btn-secondary" type="button">Экспорт</button>
        <button id="btn-import-pack" class="btn btn-secondary" type="button">Импорт</button>
        <button id="btn-create" class="btn btn-primary" type="button">Создать</button>
        <input id="import-pack-input" type="file" accept=".reportspack.json,.json" hidden />
      </div>
    </header>

    <main class="main-area">
      <section id="scenario-list" class="scenario-list"></section>
      <section id="empty-state" class="empty-state" hidden>
        <h2>Сценариев пока нет</h2>
        <p>Нажмите «Создать», выберите шаблон и добавьте действия.</p>
      </section>
    </main>
  </div>

  <div id="scenario-modal" class="modal hidden" role="dialog" aria-modal="true">
    <div class="modal-backdrop"></div>
    <div class="modal-card">
      <header class="modal-header">
        <div>
          <h2 id="modal-title">Новый сценарий</h2>
          <p class="modal-subtitle">Настройка действий без кода</p>
        </div>
        <button id="btn-close-modal" class="btn btn-ghost" type="button">Закрыть</button>
      </header>

      <section class="modal-section">
        <div class="form-grid">
          <label class="field">
            <span>Название сценария</span>
            <input id="scenario-name" type="text" placeholder="Например: Отчет по контракту" />
          </label>
          <label class="field">
            <span>Шаблон</span>
            <div class="field-row">
              <input id="scenario-template" type="text" placeholder="Путь к .xlsx шаблону" />
              <button id="btn-pick-template" class="btn btn-secondary" type="button">Выбрать</button>
            </div>
            <small id="template-help" class="field-help">Можно выбрать любой .xlsx: при сохранении сценария шаблон копируется в reports-ui/templates и переименовывается по названию сценария.</small>
            <input id="template-file-input" type="file" accept=".xlsx,.xlsm,.xls" hidden />
          </label>
          <label class="field field-full">
            <span>Описание</span>
            <textarea id="scenario-description" rows="2" placeholder="Кратко: что делает сценарий"></textarea>
          </label>
        </div>
      </section>

      <section class="modal-section">
        <div class="section-head">
          <h3>Поля ввода перед запуском</h3>
          <div class="section-actions">
            <button id="btn-add-input-field" class="btn btn-secondary" type="button">Добавить поле</button>
            <button id="btn-toggle-input-section" class="btn btn-ghost" type="button" aria-expanded="true">Свернуть</button>
          </div>
        </div>
        <div id="input-section-body" class="section-body">
          <p class="section-note">Если поля добавлены, перед запуском откроется форма ввода значений.</p>
          <div id="input-field-list" class="input-field-list"></div>
          <div class="section-tail">
            <button id="btn-add-input-field-bottom" class="btn btn-secondary" type="button">Добавить поле</button>
          </div>
        </div>
      </section>

      <section class="modal-section">
        <div class="section-head">
          <h3>Действия сценария</h3>
          <div class="section-actions">
            <button id="btn-add-action" class="btn btn-secondary" type="button">Добавить действие</button>
            <button id="btn-toggle-action-section" class="btn btn-ghost" type="button" aria-expanded="true">Свернуть</button>
          </div>
        </div>
        <div id="action-section-body" class="section-body">
          <p class="section-note">Порядок важен: действия выполняются сверху вниз. Порядок можно менять стрелками.</p>
          <div id="action-list" class="action-list"></div>
          <div class="section-tail">
            <button id="btn-add-action-bottom" class="btn btn-secondary" type="button">Добавить действие</button>
          </div>
        </div>
      </section>

      <footer class="modal-footer">
        <button id="btn-cancel" class="btn btn-ghost" type="button">Отмена</button>
        <button id="btn-save" class="btn btn-primary" type="button">Сохранить сценарий</button>
      </footer>
    </div>
  </div>

  <div id="run-input-modal" class="modal hidden" role="dialog" aria-modal="true">
    <div class="modal-backdrop"></div>
    <div class="modal-card">
      <header class="modal-header">
        <div>
          <h2 id="run-input-title">Заполнение отчета</h2>
          <p class="modal-subtitle">Введите значения полей для генерации файла</p>
        </div>
        <button id="btn-run-input-cancel" class="btn btn-ghost" type="button">Отмена</button>
      </header>
      <section class="modal-section">
        <div id="run-input-fields" class="run-input-fields"></div>
      </section>
      <footer class="modal-footer">
        <button id="btn-run-input-submit" class="btn btn-primary" type="button">Сгенерировать</button>
      </footer>
    </div>
  </div>

  <div id="list-editor-modal" class="modal hidden" role="dialog" aria-modal="true">
    <div class="modal-backdrop"></div>
    <div class="modal-card modal-card-compact">
      <header class="modal-header">
        <div>
          <h2 id="list-editor-title">Редактор списка</h2>
          <p id="list-editor-subtitle" class="modal-subtitle">Каждый вариант вводится с новой строки.</p>
        </div>
        <button id="btn-list-editor-close" class="btn btn-ghost" type="button">Закрыть</button>
      </header>
      <section class="modal-section">
        <label class="field field-full">
          <span>Элементы списка</span>
          <textarea id="list-editor-text" rows="12" placeholder="Каждый вариант с новой строки"></textarea>
          <small class="field-help">Можно вставить список целиком: один элемент = одна строка.</small>
        </label>
      </section>
      <footer class="modal-footer">
        <button id="btn-list-editor-cancel" class="btn btn-ghost" type="button">Отмена</button>
        <button id="btn-list-editor-apply" class="btn btn-primary" type="button">Применить</button>
      </footer>
    </div>
  </div>

  <div id="export-pack-modal" class="modal hidden" role="dialog" aria-modal="true">
    <div class="modal-backdrop"></div>
    <div class="modal-card modal-card-compact">
      <header class="modal-header">
        <div>
          <h2>Экспорт сценариев</h2>
          <p class="modal-subtitle">Выберите один или несколько сценариев для экспорта.</p>
        </div>
        <button id="btn-export-pack-close" class="btn btn-ghost" type="button">Закрыть</button>
      </header>
      <section class="modal-section">
        <div id="export-pack-list" class="export-pack-list"></div>
      </section>
      <footer class="modal-footer">
        <button id="btn-export-pack-cancel" class="btn btn-ghost" type="button">Отмена</button>
        <button id="btn-export-pack-submit" class="btn btn-primary" type="button">Готово</button>
      </footer>
    </div>
  </div>

  <div id="toast" class="toast hidden"></div>

  <script src="app.js?v=20260218-02"></script>
</body>
</html>
